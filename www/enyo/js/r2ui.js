var r2ui={};r2ui.selected_panel="Disassembler",r2ui.history=[],r2ui.history_idx=0,r2ui.colors={},r2ui.load_colors=function(){r2.cmdj("ecj",function(a){for(var b in a)r2ui.colors[".ec_"+b.replace("gui.","gui_")]="rgb("+String(a[b])+")"});for(var a in document.styleSheets){var b=document.styleSheets[a],c=b.cssRules?b.cssRules:b.rules;for(var d in c)if(void 0!==c[d].selectorText&&null!==c[d].selectorText&&0===c[d].selectorText.toLowerCase().indexOf(".ec_")){var e=c[d].selectorText,f=r2ui.colors[e];void 0!==f&&null!==f?".ec_gui_background"==e||".ec_gui_alt_background"==e?c[d].style.backgroundColor=f:".ec_border"==e?c[d].style.borderColor=f:c[d].style.color=f:".ec_gui_background"==e||".ec_gui_alt_background"==e?r2ui.colors[e]=c[d].style.backgroundColor:".ec_gui_border"==e?r2ui.colors[e]=c[d].style.borderColor:r2ui.colors[e]=c[d].style.color}}},r2ui.basic_blocks={},r2ui.use_sdb=!1,r2ui.get_fcn_BB=function(a,b){if(r2ui.use_sdb){var c="webui/graph/"+a+"/"+b,d=void 0;return r2.cmd("k "+c,function(a){var b=decodeURIComponent(a).split("\n");for(var c in b){var e=b[c];if(""!==e){d={};var f=e.split(",");d.x=f[0],d.y=f[1],""!=f[2]&&void 0!==f[2]||(f[2]="transparent"),d.color=f[2].replace(/\*\*/g,",")}}}),d}return r2ui.basic_blocks[b]},r2ui.get_fcn_BBs=function(a){if(r2ui.use_sdb){var b="webui/graph/"+a+"/*",c={};return r2.cmd("k "+b,function(a){var b=decodeURIComponent(a).split("\n");for(var d in b){var e=b[d];if(""!==e){offset=e.split("=")[0],e=e.split("=")[1];var f={},g=e.split(",");f.x=g[0],f.y=g[1],""!=g[2]&&void 0!==g[2]||(g[2]="transparent"),f.color=g[2].replace(/\*\*/g,","),c[offset]=f}}}),c}return r2ui.basic_blocks},r2ui.update_fcn_BB=function(a,b,c){if(r2ui.use_sdb){var d="webui/graph/"+a+"/"+b;void 0===c.color&&(c.color="transparent");var e=c.x+","+c.y+","+c.color.replace(/,/g,"**");r2.cmd("k "+d+"="+encodeURIComponent(e),function(a){})}else r2ui.basic_blocks[b]=c},r2ui.current_fcn_offset=null,r2ui.graph=null,r2ui.console_lang="r2",r2ui.toggle_console_lang=function(){"r2"==r2ui.console_lang?r2ui.console_lang="js":"js"==r2ui.console_lang&&(r2ui.console_lang="r2"),$("#cmd_input > label").html(r2ui.console_lang)},r2ui.history_push=function(a){a!=r2ui.history_last()&&(r2ui.history_idx!=r2ui.history.length&&(r2ui.history=r2ui.history.splice(0,r2ui.history_idx)),r2ui.history_idx++,r2ui.history.push(a))},r2ui.history_pop=function(){return r2ui.history_idx==r2ui.history.length&&r2ui.history_idx--,r2ui.history.pop()},r2ui.history_last=function(){return r2ui.history.length>0?r2ui.history[r2ui.history_idx-1]:void 0},r2ui.history_prev=function(){return r2ui.history_idx>1&&r2ui.history_idx--,r2ui.history[r2ui.history_idx-1]},r2ui.history_next=function(){var a=r2ui.history[r2ui.history_idx];return r2ui.history_idx<r2ui.history.length&&r2ui.history_idx++,a},r2ui.next_instruction=function(){var a=parseInt(r2ui.history_last(),16);return r2.cmd("pdl 1",function(b){a+=parseInt(b.trim())}),"0x"+a.toString(16)},r2ui.prev_instruction=function(){var a=parseInt(r2ui.history_last(),16);return r2.cmdj("pdfj",function(b){if(void 0!==b&&null!==b)for(var c in b.ops)if(0!==c){var d=b.ops[c];if(d.offset==a){a=b.ops[c-1].offset;break}}}),"0x"+a.toString(16)},r2ui.seek=function(a,b,c){if(void 0!==a){if(0===a.indexOf("0x"))a=address_canonicalize(a);else{var d=r2.get_flag_address(a);null!==d?a=address_canonicalize(d):r2.cmd("s "+a+";s",function(b){a=address_canonicalize(b.replace("\n",""))})}b&&r2ui.history_push(a),r2.cmd("s "+a,function(){r2ui._dis.seek(a,c),r2ui._hex.seek(a,c)})}},r2ui.seek_in_graph=function(a,b){b&&r2ui.history_push(a),r2.cmd("s "+a,function(){rehighlight_iaddress(a),r2ui._hex.seek(a),r2ui._hex.scrollTo(0,0)})},r2ui.seek_prev=function(){var a=r2ui.history.pop();r2.cmd("s "+a,function(){r2ui._dis.seek(a),r2ui._dis.scrollTo(0,0),r2ui._hex.seek(a),r2ui._hex.scrollTo(0,0)})},r2ui.openpage=function(a,b){void 0===b&&(b=a,a=void 0),void 0!==a&&r2ui.seek(a,!0),2==r2ui.ra.getIndex()&&r2ui.ra.setIndex(1),r2ui.mp.openPage(b)},r2ui.opendis=function(a){r2ui.openpage(a,0)},r2ui.openhex=function(a){r2ui.openpage(a,2)};