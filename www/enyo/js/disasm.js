function toggle_minimap(){r2ui._dis.minimap?(r2ui._dis.minimap=!1,r2ui.seek(r2ui._dis.selected_offset,!1),$("#minimap").hide()):(r2ui._dis.minimap=!0,r2ui.seek(r2ui._dis.selected_offset,!1),$("#minimap").show())}function update_minimap(){if(r2ui._dis.minimap&&$("#canvas svg").length){var a=200,b=200,c=$("#canvas svg")[0].getBBox().width,d=$("#canvas svg")[0].getBBox().height,e=Math.ceil(c/a),f=Math.ceil(d/b),g=1/Math.max(e,f),h=0;f>e&&(h=a/2-c*g/2);var i=null;$("#radareApp_mp").length?i=$("#main_panel"):$("#main_panel").length&&(i=$("#center_panel")),i.scrollTop()<d&&($("#minimap_area").width(i.width()*g),$("#minimap_area").height(i.height()*g),i.scrollTop()*g<=b-i.height()*g&&$("#minimap_area").css("top",i.scrollTop()*g),$("#minimap_area").css("left",h+i.scrollLeft()*g)),i=$("#center_panel"),$("#radareApp_mp").length?($("#minimap").css("display","none"),$("#minimap").css("left",i.scrollLeft()+i.width()-a-$("#radareApp_mp").position().left+2*i.css("padding").replace("px","")),$("#minimap").css("top",i.scrollTop()),$("#minimap").css("display","block")):$("#main_panel").length&&($("#minimap").css("left",i.scrollLeft()+$("#main_panel").width()-a),$("#minimap").css("top",i.scrollTop())),$("#minimap").css("border","1px solid "+r2ui.colors[".ec_gui_background"]),$("#minimap_area").css("background",r2ui.colors[".ec_gui_background"])}}function reposition_graph(){var a=r2ui.graph.getElements(),b=r2ui.get_fcn_BBs(r2ui.current_fcn_offset),c=Object.keys(b);for(var d in a){found=!1;for(var e in c){var f=String(c[e]),g=b[f];if(a[d].prop("id")===f){found=!0,"null"!==g.x&&"null"!==g.y&&a[d].translate(g.x-a[d].prop("position").x,g.y-a[d].prop("position").y);var h=g.color;null!==h&&void 0!==h&&a[d].attr("rect/fill",h)}}}}function render_graph(a){var b;try{b=JSON.parse(a.replace(/\\l/g,"\\n"))}catch(c){console.log("Cannot parse JSON data")}if(void 0===b[0])return!1;if(void 0===b[0].blocks)return!1;var d=new BBGraph;r2ui.current_fcn_offset=b[0].blocks[0].ops[0].offset;for(var e=0;e<b[0].blocks.length;e++){var f=b[0].blocks[e],g=f.offset;if(void 0!==f.trace){var h=r2ui.get_fcn_BB(r2ui.current_fcn_offset,g);void 0!==h?"red"!==h.color&&(h.color="#7592DF"):h={x:null,y:null,color:"#7592DF"},r2ui.update_fcn_BB(r2ui.current_fcn_offset,g,h)}if(0!==f.length){var i=f.ops.length,j="";for(var k in f.ops){var l=f.ops[k];void 0===l.comment||null===l.comment?l.comment="":l.comment=atob(l.comment),j+=html_for_instruction(l)}var m=document.createElement("div");m.id="bb_"+g,m.className="basicblock enyo-selectable ec_gui_background ec_gui_border",m.innerHTML=j,d.addVertex(g,i,m),f.fail>0?(d.addEdge(g,f.fail,"red"),f.jump>0&&d.addEdge(g,f.jump,"green")):f.jump>0&&d.addEdge(g,f.jump,"blue")}}d.render();var n=$("#canvas svg g .element");return n.on("mousedown",function(a){flag=0}),n.on("mousemove",function(a){flag=1}),n.on("mouseup",function(a){if(0===flag){var b=a.target.parentNode.parentNode.parentNode.getAttribute("model-id");if("minimap_area"!==b){var c=r2ui.get_fcn_BB(r2ui.current_fcn_offset,b);void 0!==c&&null!==c?"red"===c.color?c.color=r2ui.colors[".ec_gui_alt_background"]:c.color="red":c={x:"null",y:"null",color:"red"},r2ui.update_fcn_BB(r2ui.current_fcn_offset,b,c),reposition_graph()}}}),$(".addr").css("-webkit-user-select","text"),!0}function render_instructions(a){var b=document.createElement("div");b.id="outergbox";var c=document.getElementById("canvas");c.innerHTML="";var d=document.createElement("div");d.id="gbox",d.className="ec_gui_background",b.appendChild(d),c.appendChild(b);var e=getOffsetRect(c),f=r2.settings["asm.lines"],g=r2.settings["asm.offset"],h=e.top,i=[],j={},k=a[0].offset,l=a[a.length-1].offset;for(var m in a){var n=a[m];if(("jmp"==n.type||"cjmp"==n.type)&&void 0!==n.jump&&null!==n.jump){var o={};o.from=n.offset,l<n.jump?(o.to_end=!1,o.to=l):k>n.jump?(o.to_end=!1,o.to=k):(o.to_end=!0,o.to=n.jump),"jmp"==n.type?(o.color=r2ui.colors[".ec_flow"],o.dashed=!1):"cjmp"==n.type&&(o.color=r2ui.colors[".ec_gui_cflow"],o.dashed=!0),o.to_start=!0,i[i.length]=o,void 0===j[o.to]&&(j[o.to]=0)}if(void 0===n.comment||null===n.comment)n.comment="";else try{n.comment=atob(n.comment)}catch(p){console.log(n.comment)}var q=document.createElement("div");f?q.className="instructionbox enyo-selectable lines":q.className="instructionbox",q.style.top=h+"px",q.innerHTML=html_for_instruction(n),d.appendChild(q);var r=getOffsetRect(q),s=r.bottom-r.top;h+=s}if(f){var t=document.createElement("canvas");t.width=500,t.height=h,t.id="linecanvas",t.setAttribute("tabindex","1"),t.setAttribute("style","outline: none;"),d.appendChild(t);var u=t.getContext("2d");u.setLineDash||(u.setLineDash=function(){});var v=countProperties(j),w=0,x=100;for(var y in i){var o=i[y],z="0x"+o.from.toString(16),A="0x"+o.to.toString(16);0===j[o.to]&&(j[o.to]=(v-w-1)*(90/(v+1)),w+=1);var B=get_element_by_address(z),C=get_element_by_address(A);if(null!==B&&void 0!==B&&void 0!==C&&null!==C){var D=j[o.to],E=getOffsetRect(B),F=(E.top+E.bottom)/2,G=getOffsetRect(C),H=(G.top+G.bottom)/2;o.to==a[0].offset&&(H=0),u.beginPath(),u.moveTo(D,F),u.lineTo(D,H),u.strokeStyle=o.color,o.dashed&&u.setLineDash([2,3]),u.stroke(),o.to_start&&(u.beginPath(),u.moveTo(D,F),u.lineTo(x-5,F),u.strokeStyle=o.color,o.dashed&&u.setLineDash([2,3]),u.stroke(),u.beginPath(),u.arc(x-5-2,F,2,0,2*Math.PI,!1),u.fillStyle=o.color,u.fill()),o.to_end&&(u.beginPath(),u.moveTo(D,H),u.lineTo(x-5,H),u.strokeStyle=o.color,o.dashed&&u.setLineDash([2,3]),u.stroke(),u.beginPath(),u.moveTo(x-5,H),u.lineTo(x-10,H-5),u.lineTo(x-10,H+5),u.lineWidth=1,u.fillStyle=o.color,u.fill())}}}if(!g){var I=document.getElementsByClassName("insaddr");for(var J in I)I[J].style&&(I[J].style.display="none")}$(".addr").css("-moz-user-select","text"),$(".addr").css("-webkit-user-select","text")}function getOffsetRect(a){var b=a.getBoundingClientRect(),c=$("#gbox").offset().top,d=b.top-c,e=b.bottom-c;return{top:Math.round(d),bottom:Math.round(e)}}function countProperties(a){var b=0;for(var c in a)a.hasOwnProperty(c)&&++b;return b}function toBoolean(a){return"true"===a?!0:"false"===a?!1:void 0}function html_for_instruction(a){var b='<div class="instruction enyo-selectable">',c="0x"+a.offset.toString(16),d=c,e=r2.settings["asm.flags"],f=r2.settings["asm.bytes"],g=r2.settings["asm.xrefs"],h=r2.settings["asm.cmtright"];if(a.fcn_addr>0&&c==="0x"+a.fcn_addr.toString(16)){"flat"==r2ui._dis.display&&(b+='<div class="ec_flow">; -----------------------------------------------------------</div>');var i,j="afij "+c+";afvj "+c+";afaj "+c;r2.cmd(j,function(a){i=a.split("\n")});var k=JSON.parse(i[0]);null!==k&&void 0!==k&&k.length>0&&(b+='<div class="ec_fname">(fcn) '+k[0].name+"</div>");var l=JSON.parse(i[1]),m=[];for(var n in l)b+='<div class="ec_flag">; '+l[n].kind+" "+l[n].type+" <span class='fvar id_"+address_canonicalize(c)+"_"+l[n].ref+" ec_prompt faddr faddr_"+address_canonicalize(c)+"'>"+escapeHTML(l[n].name)+"</span> @ "+l[n].ref+"</div>",m[m.length]={name:l[n].name,id:address_canonicalize(c)+"_"+l[n].ref};r2.varMap[a.fcn_addr]=m;var o=JSON.parse(i[2]),p=[];for(var n in o)b+='<div class="ec_flag">; '+o[n].kind+" "+o[n].type+" <span class='farg id_"+address_canonicalize(c)+"_"+o[n].ref+" ec_prompt faddr faddr_"+address_canonicalize(c)+"'>"+escapeHTML(o[n].name)+"</span> @ "+o[n].ref+"</div>",p[p.length]={name:o[n].name,id:address_canonicalize(c)+"_"+o[n].ref};r2.argMap[a.fcn_addr]=p}if(e){var q;q=void 0!==a.flags&&null!==a.flags?a.flags.join(";"):r2.get_flag_names(address_canonicalize(c)).join(";"),""!==q&&void 0!==q&&null!==q&&(b+='<div class="ec_flag flags_'+address_canonicalize(c)+'">;-- '+escapeHTML(q)+":</div> ")}if(a.comment&&!h&&(b+='<div class="comment ec_comment comment_'+address_canonicalize(c)+'">; '+escapeHTML(a.comment)+"</div>"),g&&void 0!==a.xrefs&&null!==a.xrefs&&a.xrefs.length>0)for(var n in a.xrefs){var r=a.xrefs[n],s="",t="0x"+r.addr.toString(16);r2.get_flag_names(address_canonicalize(t)).length>0&&(s=" ("+r2.get_flag_names(address_canonicalize(t)).join(";")+")"),b+='<div class="ec_flag xrefs">; '+r.type.toUpperCase()+' XREF from <span class="offset addr addr_'+address_canonicalize(t)+'">'+t+"</span> "+s+"</div> "}if(b+='<span class="insaddr datainstruction ec_offset addr addr_'+address_canonicalize(c)+'">'+d+"</span> ",f&&void 0!==a.bytes&&null!==a.bytes&&""!==a.bytes){var u=function(a){return"00"==a?'<span class="ec_b0x00">00</span>':"ff"==a?'<span class="ec_b0x00">ff</span>':"7f"==a?'<span class="ec_b0x00">7f</span>':void 0},v=a.bytes.replace(new RegExp("(00)|(ff)|(7f)","g"),u);b+='<span class="bytes ec_other">'+v+"</span> "}var w=highlight_instruction(a.opcode,!0);if(null!==r2.varMap[a.fcn_addr]&&void 0!==r2.varMap[a.fcn_addr]&&r2.varMap[a.fcn_addr].length>0||null!==r2.argMap[a.fcn_addr]&&void 0!==r2.argMap[a.fcn_addr]&&r2.argMap[a.fcn_addr].length>0){for(var n in r2.varMap[a.fcn_addr]){var x=r2.varMap[a.fcn_addr][n].name,y=r2.varMap[a.fcn_addr][n].id;w=w.replace(" "+x+" "," <span class='fvar id_"+y+" ec_prompt faddr faddr_"+address_canonicalize(c)+"'>"+escapeHTML(x)+"</span> ")}for(var n in r2.argMap[a.fcn_addr]){var z=r2.argMap[a.fcn_addr][n];r2.argMap[a.fcn_addr][n].id,w=w.replace(" "+z+" "," <span id='fvar id_"+y+" ec_prompt faddr faddr_"+address_canonicalize(c)+"'>"+escapeHTML(x)+"</span> ")}}return void 0!==a.type&&null!==a.type?(contains(math,a.type)&&(a.type="math"),contains(bin,a.type)&&(a.type="bin"),"ill"==a.type&&(a.type="invalid"),"null"==a.type&&(a.type="invalid"),"undefined"==a.type&&(a.type="invalid"),"ujmp"==a.type&&(a.type="jmp"),"upush"==a.type&&(a.type="push"),"upop"==a.type&&(a.type="pop"),"ucall"==a.type&&(a.type="call"),"lea"==a.type&&(a.type="mov"),contains(known_types,a.type)||(a.type="other"),b+='<div class="instructiondesc ec_'+a.type+'">'+w+"</div> "):b+='<div class="instructiondesc">'+w+"</div> ",a.ptr_info&&(b+='<span class="comment ec_comment comment_'+address_canonicalize(c)+'">'+escapeHTML(a.ptr_info)+"</span>"),a.comment&&h&&(b+='<span class="comment ec_comment comment_'+address_canonicalize(c)+'"> ; '+escapeHTML(a.comment)+"</span>"),"ret"==a.type&&(b+="<div>&nbsp</div>"),b+="</div>"}function highlight_instruction(a,b){function c(a){if("0x"!=a.substr(0,2))return f[a];var b=r2.get_flag_names(address_canonicalize(a));for(var c in b){if(b[c].indexOf("sym.imp."))return"<span class='ec_offset addr addr_"+address_canonicalize(a)+"'>"+b[c]+"</span>";if(b[c].indexOf("fcn."))return"<span class='ec_offset addr addr_"+address_canonicalize(a)+"'>"+b[c]+"</span>"}var d=get_data_type(a);return""===d?"<span class='ec_num'>"+a+"</span>":"datainstruction"===d?"<span class='ec_offset addr addr_"+address_canonicalize(a)+"'>"+a+"</span>":"datamemory"===d?"<span class='ec_dataoffset'>"+a+"</span>":void 0}if(void 0===a)return"undefined";void 0===b&&(b=!0);var d=escapeHTML(a),e="(0x[0123456789abcdef]+)",f={};if(b){for(var g in regs){var h='<span class="ec_reg">'+regs[g]+"</span>";f[regs[g]]=h,h='<span class="ec_reg">'+regs[g].toLowerCase()+"</span>",f[regs[g].toLowerCase()]=h}for(g in f)e+="|("+g+")"}return d.replace(new RegExp(e,"g"),c)}function hex2(a){if(void 0===a)return"__";var b=a.toString(16);return 1==b.length?"0"+b:b}function hex(a){return void 0===a?"":(0>a&&(a+=4294967296),"0x"+a.toString(16))}function get_data_type(a,b){var c=r2.get_address_type(a);return""===c?"":void 0!==b?"data"+c+" addr addr_"+a:"data"+c}function fnum(a){return parseInt(a,10)}function get_address_from_class(a,b){void 0===b&&(b="addr");var c=b+"_";if(a){var d=a.className.split(" ").filter(function(a){return a.substr(0,c.length)==b+"_"});if(1==d.length)return d[0].split("_")[1].split(" ")[0]}}function rehighlight_iaddress(a,b){void 0===b&&(b="addr"),$(".autohighlighti").removeClass("autohighlighti"),$("."+b+"_"+a).addClass("autohighlighti"),"addr"===b&&r2.cmd("s "+a,function(){})}function rehighlight_id(a){$(".autohighlighti").removeClass("autohighlighti"),$("#"+a).addClass("autohighlighti")}function get_element_by_address(a){var b=$(".insaddr.addr_"+a);return 1===b.length?b[0]:null}function scroll_to_address(a){var b=$(".insaddr.addr_"+a),c=b[0].documentOffsetTop()-window.innerHeight/2;c=Math.max(0,c),$("#main_panel").scrollTo({top:c,left:0})}function has_scrollbar(a){return a.scrollHeight>a.clientHeight}function on_scroll(a){if(!r2ui._dis.scrolling){var b=!!$("#radareApp").length,c=!1;if(b||(c=0===$("#main_panel").tabs("option","active")),r2ui._dis.scrolling=!0,"flat"==r2ui._dis.display&&(b||c)){var d=null,e=null,f=null;b?(d=$("#main_panel").scrollTop(),e=$("#gbox").height()-$("#main_panel").height()-10,container_element=$("#center_panel")):(d=$("#center_panel").scrollTop(),e=$("#gbox").height()-$("#center_panel").height()-10,container_element=$("#disasm_tab")),has_scrollbar($("#center_panel")[0])&&(0===d?(f="0x"+r2ui._dis.instructions[0].offset.toString(16),r2.get_disasm_before(f,50,function(a){r2ui._dis.instructions=a.concat(r2ui._dis.instructions)}),container_element.html("<div id='canvas' class='canvas enyo-selectable ec_gui_background'></div>"),render_instructions(r2ui._dis.instructions),scroll_to_address(f),rehighlight_iaddress(r2ui._dis.selected_offset)):d>e&&(f="0x"+r2ui._dis.instructions[r2ui._dis.instructions.length-1].offset.toString(16),r2.get_disasm_after(f,100,function(a){r2ui._dis.instructions=r2ui._dis.instructions.slice(0,-1).concat(a)}),container_element.html("<div id='canvas' class='canvas enyo-selectable ec_gui_background'></div>"),render_instructions(r2ui._dis.instructions),scroll_to_address(f),rehighlight_iaddress(r2ui._dis.selected_offset)))}r2ui._dis.scrolling=!1,a.preventDefault()}}function scroll_to_element(a){var b=a.documentOffsetTop()-window.innerHeight/2;b=Math.max(0,b),$("#main_panel").scrollTo({top:b,left:0})}function rename(a,b,c,d){if(void 0===d&&(d="functions"),"functions"==d&&r2.cmdj("pdfj @ "+a,function(b){null!==b&&void 0!==b&&"0x"+b.addr.toString(16)===a&&r2.cmd("afn "+c+" "+a,function(){r2.update_flags()})}),""!==c&&""!==b){var e="fs "+d+";fr "+b+" "+c;r2.cmd(e,function(){})}else if(""===c&&""!==b){var e="fs "+d+";f-@"+a;r2.cmd(e,function(){})}else if(""!==c&&""===b){var e="fs "+d+";f "+c+" @ "+a;r2.cmd(e,function(){})}r2.update_flags()}function address_canonicalize(a){for(a=a.substr(2);"0"==a.substr(0,1);)a=a.substr(1);return a="0x"+a,a=a.toLowerCase()}function contains(a,b){for(var c=0;c<a.length;c++)if(a[c]===b)return!0;return!1}function handleInputTextChange(){r2ui._dis.handleInputTextChange()}function show_contextMenu(a,b){r2ui._dis.showContextMenu(a,b)}function get_offset_flag(a){var b="";return r2.cmdj("fs offsets;fj",function(c){for(var d in c)if("0x"+c[d].offset.toString(16)==a){b=c[d].name;break}}),b}function get_symbol_flag(a){var b=a,c=!1;return r2.cmdj("fs symbols;fj",function(d){for(var e in d)if(d[e].name==a){c=!0;break}if(!c)for(var e in d)if(d[e].name=="sym."+a){b="sym."+a;break}}),b}function get_reloc_flag(a){var b=a,c=!1;return r2.cmdj("fs relocs;fj",function(d){for(var e in d)if(d[e].name==a){c=!0;break}if(!c)for(var e in d)if(d[e].name=="reloc."+a){b="reloc."+a;break}}),b}function createCookie(a,b,c){if(c){var d=new Date;d.setTime(d.getTime()+24*c*60*60*1e3);var e="; expires="+d.toGMTString()}else var e="";document.cookie=a+"="+b+e+"; path=/"}function readCookie(a){for(var b=a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "==e.charAt(0);)e=e.substring(1,e.length);if(0==e.indexOf(b))return e.substring(b.length,e.length)}return null}function eraseCookie(a){createCookie(a,"",-1)}function do_randomcolors(a,b){r2.cmd("ecr;ec gui.background rgb:000",function(){r2ui.load_colors()})}function inColor(a){return"e scr.color=true;"+a+";e scr.color=false"}var BBGraph=function(){this.vertices={},this.edges=[],this.elements=[],this.links=[],this.fcn_offset=0,joint.shapes.html={},joint.shapes.html.Element=joint.shapes.basic.Rect.extend({defaults:joint.util.deepSupplement({type:"html.Element",attrs:{rect:{stroke:r2ui.colors[".ec_gui_border"],fill:r2ui.colors[".ec_gui_alt_background"]}}},joint.shapes.basic.Rect.prototype.defaults)}),joint.shapes.html.ElementView=joint.dia.ElementView.extend({initialize:function(){_.bindAll(this,"updateBox"),joint.dia.ElementView.prototype.initialize.apply(this,arguments),this.$box=$(_.template(this.model.get("html"))()),this.$box.find("input").on("mousedown click",function(a){a.stopPropagation()}),this.model.on("change",this.updateBox,this),this.updateBox()},render:function(){return joint.dia.ElementView.prototype.render.apply(this,arguments),this.paper.$el.prepend(this.$box),this.updateBox(),this},updateBox:function(a){var b=this.model.getBBox();this.$box.css({width:b.width+2,height:b.height-6,left:b.x-1,top:b.y+7})}})};BBGraph.prototype.addVertex=function(a,b,c){if(void 0===this.vertices[a]&&(this.vertices[a]={},this.vertices[a].parents=[],this.vertices[a].children=[],void 0===b)){this.vertices[a].len=1;var c=document.createElement("div");c.id="bb_"+a,c.className="basicblock enyo-selectable ec_gui_background ec_gui_border",c.innerHTML="<div class='instruction enyo-selectable'><span class='insaddr datainstruction ec_offset addr addr_0x"+a.toString(16)+"' >0x"+a.toString(16)+"</span></div>",this.vertices[a].rendered=c}void 0!==b&&(this.vertices[a].len=b,this.vertices[a].rendered=c)},BBGraph.prototype.addEdge=function(a,b,c){this.addVertex(a),this.addVertex(b),this.edges.push({from:a,to:b,color:c}),this.vertices[a].children.push(b),this.vertices[b].parents.push(a)},BBGraph.prototype.makeElement=function(a,b,c,d){this.elements.push(new joint.shapes.html.Element({id:String(a),size:{width:b,height:c},html:d}))},BBGraph.prototype.makeLink=function(a,b,c){this.links.push(new joint.dia.Link({source:{id:String(a)},target:{id:String(b)},attrs:{".marker-target":{d:"M 6 0 L 0 3 L 6 6 z",fill:c,stroke:c},".connection":{"stroke-width":1,stroke:c}},smooth:!0}))},adjustVertices=function(a,b){if(b=b.model||b,b instanceof joint.dia.Element)return void _.chain(a.getConnectedLinks(b)).groupBy(function(a){return _.omit([a.get("source").id,a.get("target").id],b.id)[0]}).each(function(b,c){"undefined"!==c&&adjustVertices(a,_.first(b))});var c=b.get("source").id||b.previous("source").id,d=b.get("target").id||b.previous("target").id,e=_.filter(a.getLinks(),function(a){var b=a.get("source").id,e=a.get("target").id;return b===c&&e===d||b===d&&e===c});if(e.length>1){var f=r2ui.graph.getCell(c).getBBox(),h=r2ui.graph.getCell(d).getBBox();src=f.intersectionWithLineFromCenterToPoint(h.center()),dst=h.intersectionWithLineFromCenterToPoint(f.center());var i=g.line(src,dst).midpoint(),j=src.theta(dst),k=10;_.each(e,function(a,b){var c=k,d=b%2?1:-1,e=g.toRad(j+90*d),l=g.point.fromPolar(c,e,i);f.containsPoint(l)||h.containsPoint(l)?a.unset("vertices"):a.set("vertices",[{x:l.x,y:l.y}])})}},BBGraph.prototype.render=function(){var a=Object.keys(this.vertices).toString(),b=document.createElement("div");b.id="outergbox";var c=document.getElementById("canvas"),d=document.createElement("div");d.id="gbox",d.className=a,b.appendChild(d),c.appendChild(b);for(var e in this.vertices){var f=this.vertices[e].rendered;void 0!==f&&(d.appendChild(f),this.makeElement(e,f.offsetWidth,f.offsetHeight,f.outerHTML))}for(var g=0;g<this.edges.length;g++)this.makeLink(this.edges[g].from,this.edges[g].to,this.edges[g].color);$("#outergbox").remove(),this.makeElement("minimap_area",1,1,"<div id='minimap_area'>");var h=this.elements.concat(this.links),i=($("#center_panel").width(),new joint.dia.Graph),j=new joint.dia.Paper({el:$("#canvas"),gridSize:1,width:2e3,height:6e3,model:i}),k=200,l=200;$("#minimap").html(""),$("#minimap").html("");var m=new joint.dia.Paper({el:$("#minimap"),gridSize:1,width:k,height:l,model:i});i.resetCells(h),joint.layout.DirectedGraph.layout(i),r2ui.graph=i,reposition_graph(),$("#minimap .basicblock").remove(),i.getCell("minimap_area").attr({rect:{stroke:"transparent"}});var n=$("#canvas svg")[0].getBBox().width,o=$("#canvas svg")[0].getBBox().height;j.setDimensions(n+500,o+500);var p=Math.ceil(n/k),q=Math.ceil(o/l),r=1/Math.max(p,q),s=0;q>p&&(s=k/2-n*r/2),m.scale(r),m.setOrigin(s,0),$("#radareApp_mp").length?($("#minimap").css("left",$("#main_panel").width()-k-$("#main_panel").position().left),$("#minimap").css("top",$("#center_panel").position().top),$("#main_panel").bind("scroll",update_minimap)):$("#main_panel").length&&($("#minimap").css("left",$("#main_panel").width()-k),$("#minimap").css("top",$("#center_panel").position().top-40),$("#center_panel").bind("scroll",update_minimap)),j.on("cell:pointerup",function(a,b,c,d){var e=a.model,f=e.attributes.position,g=String(e.prop("id"));if(void 0!==e&&"minimap_area"!==g){var h=r2ui.get_fcn_BB(r2ui.current_fcn_offset,g);void 0!==h&&null!==h?h.x==String(f.x)&&h.y==String(f.y)||(h.x=f.x,h.y=f.y,r2ui.update_fcn_BB(r2ui.current_fcn_offset,g,h)):void 0!==h&&null!==h&&r2ui.update_fcn_BB(r2ui.current_fcn_offset,g,{x:f.x,y:f.y})}});var t=_.partial(adjustVertices,i);_.each(i.getLinks(),t),j.on("cell:pointerup",t),r2ui._dis.minimap?(update_minimap(),$("#minimap_area").draggable({containment:"parent",stop:function(a,b){var c=b.position.left/r,d=b.position.top/r;0>c&&(c=0),0>d&&(d=0),$("#radareApp_mp").length?$("#main_panel").scrollTo({top:d,left:c-s/r}):$("#center_panel").scrollTo({top:d,left:c-s/r})}})):$("#minimap").hide()};var flag=0,math=["add","sub","mul","imul","div","idiv","neg","adc","sbb","inc","dec",".byte"],bin=["xor","and","or","not"],regs=["EAX","ECX","EDX","EBX","ESP","EBP","ESI","EDI","EIP","RAX","RCX","RDX","RBX","RSP","RBP","RSI","RDI","R0","R1","R2","R3","R4","R5","R6","R7","R8","R9","R10","R11","R12","R13","R14","R15","RIP"],known_types=["fline","help","args","label","flow","prompt","input","btext","swi","comment","fname","flag","offset","other","b0x00","b0x7f","b0xff","math","bin","push","pop","jmp","cjmp","call","nop","ret","trap","invalid","cmp","reg","creg","mov","num"],escapeHTML=function(){"use strict";var a={'"':"&quot;","&":"&amp;","<":"&lt;",">":"&gt;"};return function(b){return b?b.replace(/[\"&<>]/g,function(b){return a[b]}):""}}();Element.prototype.documentOffsetTop=function(){return this.offsetTop+(this.offsetParent?this.offsetParent.documentOffsetTop():0)};